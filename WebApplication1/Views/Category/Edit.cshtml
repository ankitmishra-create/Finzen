@model FinanceManagement.Application.ViewModels.AddCategoryVM
@using FinanceManagement.Core.Enums
@using Microsoft.AspNetCore.Mvc.Rendering

@{
    ViewData["Title"] = "Edit Category";

    var categoryTypes = Enum.GetValues(typeof(CategoryType))
                           .Cast<CategoryType>()
                           .Select(e => new SelectListItem { Value = e.ToString(), Text = e.ToString() })
                           .ToList();

    var investmentSubtypes = Enum.GetValues(typeof(SubType))
                                  .Cast<SubType>()
                                  .Select(e => new SelectListItem { Value = e.ToString(), Text = e.ToString() })
                                  .ToList();
}

<div class="flex justify-between items-center mb-6">
    <h1 class="text-3xl font-bold text-gray-900">@ViewData["Title"]</h1>
    <a asp-action="Index" class="text-base font-medium text-violet-600 hover:text-violet-500">
        <i class="bi bi-arrow-left"></i>
        Back to List
    </a>
</div>

<div class="max-w-2xl mx-auto bg-white rounded-xl shadow-md p-6 sm:p-8 transition-all duration-300 hover:shadow-lg">

    <form asp-controller="Category" asp-action="Edit" method="post">
        <div asp-validation-summary="ModelOnly" class="text-red-600 text-base list-disc list-inside mb-4" role="alert"></div>

        <input type="hidden" asp-for="Id" />

        <div class="space-y-6">
            <div>
                <label asp-for="CategoryName" class="block text-base font-medium text-gray-700 mb-1"></label>
                <input asp-for="CategoryName" class="block w-full rounded-lg border-gray-400 p-2.5 shadow-sm focus:border-violet-500 focus:ring-violet-500 text-base" />
                <span asp-validation-for="CategoryName" class="text-red-600 text-base mt-1"></span>
            </div>

            <div>
                <label asp-for="CategoryType" class="block text-base font-medium text-gray-700 mb-1"></label>
                <select asp-for="CategoryType" class="block w-full rounded-lg border-gray-400 p-2.5 shadow-sm focus:border-violet-500 focus:ring-violet-500 text-base" asp-items="categoryTypes" id="categoryTypeDropdown"></select>
                <span asp-validation-for="CategoryType" class="text-red-600 text-base mt-1"></span>
            </div>

            <div class="mb-3" id="subtypeContainer" style="display:none;">
                <label asp-for="SubType" class="block text-base font-medium text-gray-700 mb-1"></label>
                <select asp-for="SubType" class="block w-full rounded-lg border-gray-400 p-2.5 shadow-sm focus:border-violet-500 focus:ring-violet-500 text-base" asp-items="investmentSubtypes">
                    <option value="">-- Select a Sub-Type --</option>
                </select>
                <span asp-validation-for="SubType" class="text-red-600 text-base mt-1"></span>
            </div>

            <div class="pt-4">
                <button type="submit" class="w-full flex justify-center py-3 px-4 border border-transparent rounded-lg shadow-sm text-lg font-medium text-white bg-violet-600 hover:bg-violet-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-violet-500 transition-all duration-3S00 transform hover:-translate-y-0.5">
                    Save Changes
                </button>
            </div>
        </div>
    </form>
</div>

@section Scripts {
    @{
        <partial name="_ValidationScriptsPartial" />
    }

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const categoryTypeDropdown = document.getElementById("categoryTypeDropdown");
            const subtypeContainer = document.getElementById("subtypeContainer");

            function toggleSubtype() {
                if (categoryTypeDropdown.value === "Investment") {
                    subtypeContainer.style.display = "block";
                } else {
                    subtypeContainer.style.display = "none";
                }
            }

            categoryTypeDropdown.addEventListener("change", toggleSubtype);
            toggleSubtype();
        });
    </script>
}