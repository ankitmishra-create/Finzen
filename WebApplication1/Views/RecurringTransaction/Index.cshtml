@using FinanceManagement.Core.Entities

@using FinanceManagement.Core.Enums

@model List<RecurringTransactions>



@{

    ViewData["Title"] = "Recurring Transactions";

}



<div class="container py-5">

    <div class="d-flex justify-content-between align-items-center mb-4">

        <h1 class="mb-0">Recurring Transactions</h1>

        <a asp-action="Create" asp-controller="Transaction" class="btn btn-primary shadow-sm">

            <i class="fas fa-plus me-2"></i>Add New

        </a>

    </div>



    @if (Model != null && Model.Any())

    {

        <div class="card shadow-sm rounded-3">

            <div class="card-body p-0">

                <div class="table-responsive">

                    <table class="table table-hover align-middle mb-0">

                        <thead class="table-light">

                            <tr>

                                <th scope="col" class="ps-4">Description</th>

                                <th scope="col">Amount</th>

                                <th scope="col">Category</th>

                                <th scope="col">Frequency</th>

                                <th scope="col">Next Transaction Date</th>

                                <th scope="col" class="text-end pe-4">Actions</th>

                            </tr>

                        </thead>

                        <tbody>

                            @foreach (var recurring in Model)

                            {

                                @if (recurring.Transaction != null && recurring.IsActive)

                                {

                                    <tr>

                                        <td class="ps-4">

                                            <div class="fw-bold">@recurring.Transaction.Description</div>

                                        </td>

                                        <td>

                                            <span class="fw-medium @(recurring.Transaction.Amount >= 0 ? "text-success" : "text-danger")">

                                                @ViewBag.CurrencySymbol @recurring.Transaction.Amount

                                            </span>

                                        </td>

                                        <td>

                                            <span class="badge bg-secondary bg-opacity-25 text-dark-emphasis">

                                                @(recurring.Transaction.Category?.CategoryName ?? "N/A")

                                            </span>

                                        </td>

                                        <td>@recurring.Frequency</td>

                                        <td>

                                            @recurring.NextTransactionDate.ToString("MMM dd, yyyy")

                                        </td>

                                        <td class="text-end pe-4">

                                            <div class="d-flex gap-2 justify-content-end">

                                                <a asp-action="Edit" asp-controller="RecurringTransaction" asp-route-transactionId="@recurring.Transaction.TransactionId" class="btn btn-sm btn-outline-secondary">

                                                    <i class="fas fa-pencil-alt me-1"></i> Edit

                                                </a>

                                                <form asp-action="Delete" asp-controller="RecurringTransaction" asp-route-recurringTransactionId="@recurring.RecurringTransactionId" method="post" onsubmit="return confirm('Are you sure you want to delete this recurring transaction?');">

                                                    <button type="submit" class="btn btn-sm btn-outline-danger">

                                                        <i class="fas fa-trash-alt me-1"></i> Delete

                                                    </button>

                                                </form>

                                            </div>

                                        </td>

                                    </tr>

                                }

                            }

                        </tbody>

                    </table>

                </div>

            </div>

        </div>

    }

    else

    {

        <div class="text-center p-5 border rounded-3 bg-light">



            <i class="fas fa-folder-open fa-3x text-muted mb-3"></i>

            <h4 class="fw-bold">No Recurring Transactions Found</h4>

            <p class="text-muted">Get started by adding a new recurring transaction to track your regular income or expenses.</p>

            <a asp-action="Create" asp-controller="Transaction" class="btn btn-primary mt-2">

                <i class="fas fa-plus me-2"></i>Add Your First One

            </a>

        </div>

    }

</div>