@model FinanceManagement.Application.ViewModels.UserRegistrationVM

@{
    ViewData["Title"] = "Create an Account";
}

<div class="min-h-screen flex items-center justify-center bg-gradient-to-br from-violet-50 via-white to-indigo-50 py-12 px-4 sm:px-6 lg:px-8">
    <div class="w-full max-w-2xl bg-white shadow-xl rounded-2xl border border-gray-100 p-8 md:p-10">
        <h2 class="text-3xl font-bold text-center text-gray-900 mb-2">@ViewData["Title"]</h2>
        <p class="text-center text-gray-500 mb-8">Join us and start managing your finances smarter.</p>

        <form asp-action="Index" method="post" class="space-y-6">
            <div asp-validation-summary="ModelOnly" class="text-red-600 text-sm text-center"></div>

            <!-- Full Name & DOB -->
            <div class="grid grid-cols-1 sm:grid-cols-2 gap-6">
                <div>
                    <label asp-for="FullName" class="block text-sm font-semibold text-gray-800 mb-1 required-field"></label>
                    <input asp-for="FullName"
                           class="w-full border border-gray-300 rounded-lg p-3 text-gray-800 focus:ring-2 focus:ring-violet-500 focus:border-violet-500"
                           placeholder="John Doe" />
                    <span asp-validation-for="FullName" class="text-red-600 text-sm"></span>
                </div>
                <div>
                    <label asp-for="DateOfBirth" class="block text-sm font-semibold text-gray-800 mb-1 required-field"></label>
                    <input asp-for="DateOfBirth"
                           type="date"
                           id="DateOfBirth"
                           class="w-full border border-gray-300 rounded-lg p-3 text-gray-800 focus:ring-2 focus:ring-violet-500 focus:border-violet-500" />
                    <span asp-validation-for="DateOfBirth" class="text-red-600 text-sm"></span>
                </div>
            </div>

            <!-- Gender & Country -->
            <div class="grid grid-cols-1 sm:grid-cols-2 gap-6">
                <div>
                    <label asp-for="Gender" class="block text-sm font-semibold text-gray-800 mb-1 required-field"></label>
                    <select asp-for="Gender"
                            class="w-full border border-gray-300 rounded-lg p-3 bg-white text-gray-800 focus:ring-2 focus:ring-violet-500 focus:border-violet-500"
                            asp-items="ViewBag.Gender">
                        <option value="">-- Select Gender --</option>
                    </select>
                    <span asp-validation-for="Gender" class="text-red-600 text-sm"></span>
                </div>
                <div>
                    <label asp-for="CurrencyId" class="block text-sm font-semibold text-gray-800 mb-1 required-field">Country</label>
                    <select asp-for="CurrencyId"
                            class="w-full border border-gray-300 rounded-lg p-3 bg-white text-gray-800 focus:ring-2 focus:ring-violet-500 focus:border-violet-500"
                            asp-items="ViewBag.Country">
                        <option value="">-- Select Country --</option>
                    </select>
                    <span asp-validation-for="CurrencyId" class="text-red-600 text-sm"></span>
                </div>
            </div>

            <!-- Email -->
            <div>
                <label asp-for="Email" class="block text-sm font-semibold text-gray-800 mb-1 required-field"></label>
                <input asp-for="Email"
                       class="w-full border border-gray-300 rounded-lg p-3 text-gray-800 focus:ring-2 focus:ring-violet-500 focus:border-violet-500"
                       placeholder="you@example.com" />
                <span asp-validation-for="Email" class="text-red-600 text-sm"></span>
            </div>

            <!-- Password & Confirm Password -->
            <div class="grid grid-cols-1 sm:grid-cols-2 gap-6">
                <div>
                    <label asp-for="Password" class="block text-sm font-semibold text-gray-800 mb-1 required-field"></label>
                    <input asp-for="Password"
                           type="password"
                           class="w-full border border-gray-300 rounded-lg p-3 text-gray-800 focus:ring-2 focus:ring-violet-500 focus:border-violet-500"
                           placeholder="••••••••" />
                    <span asp-validation-for="Password" class="text-red-600 text-sm"></span>
                </div>
                <div>
                    <label asp-for="ConfirmPassword" class="block text-sm font-semibold text-gray-800 mb-1 required-field"></label>
                    <input asp-for="ConfirmPassword"
                           type="password"
                           class="w-full border border-gray-300 rounded-lg p-3 text-gray-800 focus:ring-2 focus:ring-violet-500 focus:border-violet-500"
                           placeholder="••••••••" />
                    <span asp-validation-for="ConfirmPassword" class="text-red-600 text-sm"></span>
                </div>
            </div>

            <!-- Register Button -->
            <div>
                <button type="submit"
                        class="w-full bg-violet-600 hover:bg-violet-700 text-white font-semibold py-3 rounded-lg shadow-md focus:ring-4 focus:ring-violet-300 transition-all duration-300 transform hover:-translate-y-0.5">
                    Create Account
                </button>
            </div>
        </form>

        <!-- Divider -->
        <div class="flex items-center my-8">
            <hr class="flex-grow border-gray-300">
            <span class="px-3 text-gray-400 text-sm font-medium">OR</span>
            <hr class="flex-grow border-gray-300">
        </div>

        <!-- Google Sign In -->
        <form asp-controller="Account" asp-action="ExternalLogin" asp-route-provider="Google" method="post">
            <button type="submit"
                    class="w-full flex items-center justify-center gap-3 border border-gray-300 rounded-lg py-3 font-semibold text-gray-700 bg-white hover:bg-gray-50 shadow-sm focus:ring-2 focus:ring-violet-300 transition-all">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor"
                     class="bi bi-google text-gray-500" viewBox="0 0 16 16">
                    <path d="M15.545 6.558a9.42 9.42 0 0 1 .139 1.626c0 2.434-.87 4.492-2.384 5.885h.002C11.978 15.292 10.158 16 8
                    16A8 8 0 1 1 8 0a7.689 7.689 0 0 1 5.352 2.082l-2.284 2.284A4.347 4.347 0 0 0 8
                    3.166c-2.087 0-3.86 1.408-4.492 3.25C2.806 7.633 2.5 8.537 2.5 9.5c0
                    .963.306 1.867.834 2.653C3.96 13.592 5.713 15 8
                    15c1.453 0 2.652-.46 3.568-1.242l2.284
                    2.284A7.96 7.96 0 0 1 8 16Z" />
                </svg>
                Sign up / Sign in with Google
            </button>
        </form>

        <!-- Login Redirect -->
        <div class="text-center mt-6">
            <p class="text-gray-600 text-sm">
                Already have an account?
                <a asp-controller="Login" asp-action="Index" class="text-violet-600 hover:text-violet-500 font-semibold">Login here</a>
            </p>
        </div>
    </div>
</div>

@section Scripts {
    <partial name="_ValidationScriptsPartial" />
    <style>
        .required-field::after {
            content: " *";
            color: #e11d48;
            font-weight: bold;
        }
    </style>

    <script>
        document.addEventListener("DOMContentLoaded", function () {
            const dobInput = document.getElementById("DateOfBirth");
            if (dobInput) {
                const today = new Date();
                const maxDate = new Date(today.getFullYear() - 18, today.getMonth(), today.getDate());
                const minDate = new Date(today.getFullYear() - 100, today.getMonth(), today.getDate());

                function formatDate(date) {
                    const yyyy = date.getFullYear();
                    const mm = String(date.getMonth() + 1).padStart(2, '0');
                    const dd = String(date.getDate()).padStart(2, '0');
                    return `${yyyy}-${mm}-${dd}`;
                }

                dobInput.min = formatDate(minDate);
                dobInput.max = formatDate(maxDate);
                dobInput.value = formatDate(maxDate); // ✅ Default = 18 years ago
            }
        });
    </script>
}
